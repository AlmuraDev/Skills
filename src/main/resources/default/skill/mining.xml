<?xml version="1.0" encoding="utf-8"?>
<droplet xmlns:skills="skills" spec="1.0.0">
  <filters>
    <skills:player id="player"/>
    <all id="player-level-up">
      <filter id="player"/>
      <skills:level-change/>
    </all>
    <all id="player-level-up-not-sneaking">
      <filter id="player-level-up"/>
      <skills:data key="sponge:is_sneaking" value="false"/>
    </all>
    <all id="player-level-up-not-sneaking-max">
      <filter id="player-level-up-not-sneaking"/>
      <skills:level-change value="99"/>
    </all>
    <all id="change-block-break">
      <filter id="player"/>
      <skills:break-block/>
      <skills:data key="sponge:gamemode" value="minecraft:survival"/>
      <skills:owner value="none"/>
      <skills:notifier value="none"/>
    </all>
    <any id="stone-gravel-block">
      <block>minecraft:stone</block>
      <block>minecraft:gravel</block>
    </any>
    <all id="coal-ore-block">
      <block>minecraft:coal_ore</block>
    </all>
    <all id="coal-ore-block-level">
      <filter id="coal-ore-block"/>
      <skills:level op="greater-than" self="true" value="10"/>
    </all>
    <all id="iron-ore-block">
      <block>minecraft:iron_ore</block>
    </all>
    <all id="iron-ore-block-level">
      <filter id="iron-ore-block"/>
      <skills:level op="greater-than" self="true" value="20"/>
    </all>
    <all id="gold-ore-block">
      <block>minecraft:gold_ore</block>
    </all>
    <all id="gold-ore-block-level">
      <filter id="gold-ore-block"/>
      <skills:level op="greater-than" self="true" value="30"/>
    </all>
    <all id="diamond-ore-block">
      <block>minecraft:diamond_ore</block>
    </all>
    <all id="diamond-ore-block-level">
      <filter id="diamond-ore-block"/>
      <skills:level op="greater-than" self="true" value="40"/>
    </all>
    <all id="obsidian-block">
      <block>minecraft:obsidian</block>
    </all>
    <all id="obsidian-block-level">
      <filter id="obsidian-block"/>
      <skills:level op="greater-than" self="true" value="50"/>
    </all>    
    <all id="emerald-ore-block">
      <block>minecraft:emerald_ore</block>
    </all>
    <all id="emerald-ore-block-level">
      <filter id="emerald-ore-block"/>
      <skills:level op="greater-than" self="true" value="60"/>
    </all>
    <all id="interact-item">
      <filter id="player"/>
      <skills:interact-item/>
      <skills:data key="sponge:gamemode" value="minecraft:survival"/>
    </all>
    <all id="wooden-pickaxe">
      <item>minecraft:wooden_pickaxe</item>
    </all>
    <all id="stone-pickaxe">
      <item>minecraft:wooden_pickaxe</item>
    </all>    
    <all id="stone-pickaxe-level">
      <filter id="stone-pickaxe"/>
      <skills:level op="greater-than" self="true" value="15"/>
    </all>
    <all id="iron-pickaxe">
      <item>minecraft:iron_pickaxe</item>
    </all>    
    <all id="iron-pickaxe-level">
      <filter id="iron-pickaxe"/>
      <skills:level op="greater-than" self="true" value="30"/>
    </all>
    <all id="gold-pickaxe">
      <item>minecraft:gold_pickaxe</item>
    </all>    
    <all id="gold-pickaxe-level">
      <filter id="gold-pickaxe"/>
      <skills:level op="greater-than" self="true" value="45"/>
    </all>
    <all id="diamond-pickaxe">
      <item>minecraft:diamond_pickaxe</item>
    </all>    
    <all id="diamond-pickaxe-level">
      <filter id="diamond-pickaxe"/>
      <skills:level op="greater-than" self="true" value="60"/>
    </all>   
  </filters>
  <skill name="Mining" level-function="skills:level/rs-normal" economy-function="skills:economy/standard" min-level="1" max-level="99">
    <world-share>
      <world name="DIM1" from="world"/>
      <world name="DIM-1" from="world"/>
    </world-share>
    <events>
      <change-block>
        <filter-apply>
          <apply>
            <if>
              <filter id="change-block-break"/>
            </if>
            <then>
              <apply>
                <if>
                  <not>
                    <any>
                      <filter id="coal-block-level"/>
                      <filter id="iron-ore-block-level"/>
                      <filter id="gold-ore-block-level"/>
                      <filter id="diamond-ore-block-level"/>
                      <filter id="emerald-ore-block-level"/>
                    </any>
                  </not>
                </if>
                <then>
                  <skills:cancel-transaction value="true"/>
                  <message key="action_bar" text="You lack the experience to break this block!"/>
                </then>
                <else>
                  <apply>
                    <if>
                      <filter id="stone-gravel-block"/>
                    </if>
                    <then>
                      <skills:experience op="add" value="1"/>
                      <skills:economy-modifier value="0.05"/>
                    </then>
                  </apply>
                  <apply>
                    <if>
                      <filter id="coal-ore-block"/>
                    </if>
                    <then>
                      <skills:experience op="add" value="10"/>
                      <skills:economy-modifier value="0.15"/>
                    </then>
                  </apply>
                  <apply>
                    <if>
                      <filter id="iron-ore-block"/>
                    </if>
                    <then>
                      <skills:experience op="add" value="20"/>
                      <skills:economy-modifier value="0.25"/>
                    </then>
                  </apply>
                  <apply>
                    <if>
                      <filter id="gold-ore-block"/>
                    </if>
                    <then>
                      <skills:experience op="add" value="40"/>
                      <skills:economy-modifier value="0.35"/>
                    </then>
                  </apply>
                  <apply>
                    <if>
                      <filter id="diamond-ore-block"/>
                    </if>
                    <then>
                      <skills:experience op="add" value="80"/>
                      <skills:economy-modifier value="0.45"/>
                    </then>
                  </apply>
                  <apply>
                    <if>
                      <filter id="obsidian-block"/>
                    </if>
                    <then>
                      <skills:experience op="add" value="60"/>
                      <skills:economy-modifier value="0.55"/>
                    </then>
                  </apply>                  
                  <apply>
                    <if>
                      <filter id="emerald-ore-block"/>
                    </if>
                    <then>
                      <skills:experience op="add" value="160"/>
                      <skills:economy-modifier value="0.55"/>
                    </then>
                  </apply>
                </else>
              </apply>
            </then>
          </apply>
        </filter-apply>
      </change-block>
      <interact>
        <filter-apply>
          <apply>
            <if>
              <filter id="interact-item"/>
            </if>
            <then>
              <apply>
                <if>
                  <not>
                    <any>
                      <filter id="stone-pickaxe-level"/>
                      <filter id="iron-pickaxe-level"/>
                      <filter id="gold-pickaxe-level"/>
                      <filter id="diamond-pickaxe-level"/>
                    </any>
                  </not>
                </if>
                <then>
                  <message key="action_bar" text="You lack the experience to use this item!"/>
                  <skills:data key="sponge:durability" op="add" value="-5"/>
                  <skills:cancel-transaction value="true"/>
                </then>
              </apply>
            </then>
          </apply>
        </filter-apply>
      </interact>
      <change-experience>
        <filter-apply>
          <apply>
            <if>
              <filter id="player"/>
            </if>
            <then>
              <message key="action_bar" text="+ {exp-diff}xp (`b{name}`r)"/>
            </then>
          </apply>
          <apply>
            <if>
              <filter id="player-level-up-not-sneaking-max"/>
            </if>
            <then>
              <message key="chat" text="Congratulations! You've just advanced a `b{name}`r level and are now `2{new-level}`r."/>
              <effect key="skills:firework/mining-level-max" x="0" y="2.5" z="0"/>
            </then>
            <else>
              <if>
                <filter id="player-level-up-not-sneaking"/>
              </if>
              <then>
                <message key="chat" text="Congratulations! You've just advanced a `b{name}`r level and are now `2{new-level}`r."/>
                <effect key="skills:firework/mining-level-up" x="0" y="2.5" z="0"/>
              </then>
            </else>
          </apply>
        </filter-apply>
      </change-experience>
    </events>
  </skill>
</droplet>
